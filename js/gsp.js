function inbetween(x, min, max) {
    return x >= min && x <= max;
}

const ipv4 = {
    toDecimal: function (ip) {
        return ip.split('.').reduce((int, oct) => (int << 8) + parseInt(oct, 10), 0) >>> 0;
    },

    /**
     * @param ip x.x.x.x
     * @param rangeOrCidr x.x.x.x/x or x.x.x.x-y.y.y.y
     * @returns {*|boolean}
     */
    inRange: function (ip, rangeOrCidr) {
        ip = (ip || "").trim();
        rangeOrCidr = (rangeOrCidr || "").trim();

        if (rangeOrCidr.match(/\/\d{1,3}/)) {
            return this.inRangeCidr(ip, rangeOrCidr);
        } else if (rangeOrCidr.match(/\s*-\s*/)) {
            const split = rangeOrCidr.split(/\s*-\s*/);
            return this.inRangeDash(ip, split[0], split[1])
        }
        throw new Error("Invalid range or CIDR: " + rangeOrCidr);
    },

    inRangeDash: function (ip, rangeStart, rangeEnd) {
        const decimal = this.toDecimal(ip);
        const start = this.toDecimal(rangeStart);
        const end = this.toDecimal(rangeEnd);
        return inbetween(decimal, start, end);
    },

    inRangeCidr: function (ip, cidr) {
        const [range, bits = 32] = cidr.split('/');
        const mask = ~(2 ** (32 - bits) - 1);
        return (this.toDecimal(ip) & mask) === (this.toDecimal(range) & mask);
    }
}

// VSCode Ctrl+Shift+L
// (((\d{1,3}\.){3}\d{1,3})( - ((\d{1,3}\.){3}\d{1,3})|/\d{1,3})?)
const hostIpRanges = {
    // GPortal
    // https://apps.db.ripe.net/db-web-ui/query?bflag=false&dflag=false&inverse=mnt-by%3Bmnt-lower%3Bmnt-domains%3Bmnt-routes&rflag=true&searchtext=MNT-GPORTAL&source=RIPE
    gportal: [
        "155.133.0.0 - 155.133.0.255",
        "176.57.128.0 - 176.57.128.255",
        "176.57.128.0 - 176.57.191.255",
        "176.57.128.0/18",
        "176.57.129.0 - 176.57.129.255",
        "176.57.130.0 - 176.57.130.255",
        "176.57.130.0/24",
        "176.57.131.0 - 176.57.131.255",
        "176.57.132.0 - 176.57.132.255",
        "176.57.133.0 - 176.57.133.255",
        "176.57.134.0 - 176.57.134.255",
        "176.57.134.0/24",
        "176.57.135.0 - 176.57.135.255",
        "176.57.135.0/24",
        "176.57.136.0 - 176.57.136.255",
        "176.57.137.0 - 176.57.137.255",
        "176.57.138.0 - 176.57.138.255",
        "176.57.139.0 - 176.57.139.255",
        "176.57.140.0 - 176.57.140.255",
        "176.57.141.0 - 176.57.141.255",
        "176.57.142.0 - 176.57.142.255",
        "176.57.143.0 - 176.57.143.255",
        "176.57.143.0/24",
        "176.57.144.0 - 176.57.144.255",
        "176.57.145.0 - 176.57.145.255",
        "176.57.146.0 - 176.57.146.255",
        "176.57.147.0 - 176.57.147.255",
        "176.57.148.0 - 176.57.148.255",
        "176.57.149.0 - 176.57.149.255",
        "176.57.150.0 - 176.57.150.255",
        "176.57.151.0 - 176.57.151.255",
        "176.57.152.0 - 176.57.152.255",
        "176.57.154.0 - 176.57.154.255",
        "176.57.155.0 - 176.57.155.255",
        "176.57.156.0 - 176.57.156.255",
        "176.57.157.0 - 176.57.157.255",
        "176.57.158.0 - 176.57.158.255",
        "176.57.158.0/24",
        "176.57.159.0 - 176.57.159.255",
        "176.57.160.0 - 176.57.160.255",
        "176.57.161.0 - 176.57.161.255",
        "176.57.162.0 - 176.57.162.255",
        "176.57.163.0 - 176.57.163.255",
        "176.57.164.0 - 176.57.164.255",
        "176.57.165.0/24",
        "176.57.166.0 - 176.57.166.255",
        "176.57.167.0 - 176.57.167.255",
        "176.57.169.0 - 176.57.169.255",
        "176.57.170.0 - 176.57.170.255",
        "176.57.171.0 - 176.57.171.255",
        "176.57.172.0 - 176.57.172.255",
        "176.57.173.0 - 176.57.173.255",
        "176.57.175.0 - 176.57.175.255",
        "176.57.176.0 - 176.57.176.255",
        "176.57.177.0 - 176.57.177.255",
        "176.57.178.0 - 176.57.178.255",
        "176.57.179.0 - 176.57.179.255",
        "176.57.180.0 - 176.57.180.255",
        "176.57.181.0 - 176.57.181.255",
        "176.57.182.0 - 176.57.182.255",
        "176.57.185.0 - 176.57.185.255",
        "176.57.186.0 - 176.57.186.255",
        "176.57.186.0/24",
        "176.57.190.0 - 176.57.190.255",
        "176.57.190.0/24",
        "176.57.191.160 - 176.57.191.191",
        "176.57.191.64 - 176.57.191.95",
        "176.57.191.96 - 176.57.191.127",
        "185.137.120.0 - 185.137.123.255",
        "185.137.120.0/22",
        "185.137.123.0 - 185.137.123.255",
        "185.185.81.0 - 185.185.81.255",
        "185.185.81.0/24",
        "185.208.204.0 - 185.208.205.255",
        "185.208.204.0/23",
        "185.249.226.0 - 185.249.226.255",
        "185.249.226.0/24",
        "193.192.58.0 - 193.192.59.255",
        "193.192.58.0/23",
        "193.192.58.0/24",
        "193.192.59.0/24",
        "193.22.154.0 - 193.22.155.255",
        "193.22.154.0/23",
        "193.43.71.0 - 193.43.71.255",
        "193.43.71.0/24",
        "194.113.65.0 - 194.113.65.255",
        "194.113.65.0/24",
        "45.130.107.0 - 45.130.107.255",
        "45.130.107.0/24",
        "45.137.244.0 - 45.137.245.255",
        "45.137.246.0 - 45.137.247.255",
        "83.223.192.0 - 83.223.199.255",
        "83.223.197.0 - 83.223.197.255",
        "83.223.197.0/24",
        "83.223.199.0 - 83.223.199.255",
        "83.223.199.0/24",
        "83.223.200.0 - 83.223.200.255",
        "83.223.200.0 - 83.223.207.255",
        "83.223.200.0/24",
        "83.223.201.0 - 83.223.201.255",
        "83.223.201.0/24",
        "83.223.202.0 - 83.223.202.255",
        "83.223.202.0/24",
        "83.223.203.0 - 83.223.203.255",
        "83.223.203.0/24",
        "83.223.204.0 - 83.223.204.255",
        "83.223.204.0/24",
        "83.223.205.0 - 83.223.205.255",
        "83.223.205.0/24",
        "83.223.206.0 - 83.223.206.255",
        "83.223.206.0/24",
        "83.223.207.0 - 83.223.207.255",
        "83.223.207.0/24",
        "85.202.82.0 - 85.202.82.255",
        "85.202.82.0/24",
        "94.250.192.0 - 94.250.223.255",
        "94.250.192.0/19",
        "94.250.196.0 - 94.250.196.255",
        "94.250.196.0/24",
        "94.250.200.0 - 94.250.200.255",
        "94.250.200.0/24",
        "94.250.204.0/24",
        "94.250.207.0 - 94.250.207.255",
        "94.250.207.0/24",
        "94.250.212.0/24",
        "94.250.213.0/24",
        "94.250.214.0/24",
        "94.250.215.0 - 94.250.215.255",
        "94.250.215.0/24",
        "94.250.216.0 - 94.250.216.255",
        "94.250.216.0/24",
        "94.250.218.0 - 94.250.218.255",
        "94.250.218.0/24",
        "94.250.219.0/24",
        "94.250.221.0 - 94.250.221.255",
        "94.250.221.0/24",
        "94.250.222.0 - 94.250.222.255",
        "94.250.222.0/24",
    ],
    // Streamline Servers
    // $ whois -h whois.apnic.net -i mnt-by MAINT-GSLNETWORKS-AU >gslnetworks.txt
    streamline: [
        "103.1.212.0 - 103.1.212.255",
        "103.1.213.0 - 103.1.213.255",
        "103.1.214.0 - 103.1.214.255",
        "103.1.215.0 - 103.1.215.255",
        "103.107.196.0 - 103.107.196.255",
        "103.107.197.0 - 103.107.197.255",
        "103.107.198.0 - 103.107.198.255",
        "103.107.198.176 - 103.107.198.177",
        "103.107.198.190 - 103.107.198.191",
        "103.107.199.0 - 103.107.199.255",
        "103.107.199.56 - 103.107.199.63",
        "116.90.72.0 - 116.90.72.255",
        "116.90.73.0 - 116.90.73.255",
        "116.90.74.0 - 116.90.74.255",
        "116.90.75.0 - 116.90.75.255",
        "202.165.64.0 - 202.165.64.255",
        "202.165.65.0 - 202.165.65.255",
        "202.165.66.0 - 202.165.66.255",
        "202.165.67.0 - 202.165.67.255",
        "202.165.68.0 - 202.165.68.255",
        "202.165.69.0 - 202.165.69.255",
        "202.165.70.0 - 202.165.70.255",
        "202.165.71.0 - 202.165.71.255",
        "203.10.96.0 - 203.10.96.255",
        "203.10.97.0 - 203.10.97.255",
        "203.10.98.0 - 203.10.98.255",
        "203.10.99.0 - 203.10.99.255",
        "203.15.120.0 - 203.15.120.255",
        "203.15.121.0 - 203.15.121.255",
        "203.17.244.0 - 203.17.244.255",
        "203.17.245.0 - 203.17.245.255",
        "203.23.178.0 - 203.23.178.255",
        "203.23.179.0 - 203.23.179.255",
        "203.23.179.8 - 203.23.179.15",
        "203.27.106.0 - 203.27.106.255",
        "203.27.107.0 - 203.27.107.255",
        "203.57.82.0 - 203.57.82.255",
        "203.57.83.0 - 203.57.83.255",
    ],
    // Low.MS
    // https://apps.db.ripe.net/db-web-ui/query?bflag=false&dflag=false&inverse=mnt-by%3Bmnt-domains%3Bmnt-lower%3Bmnt-routes&rflag=true&searchtext=mnt-uk-swiftpingltd-1&source=RIPE&types=inetnum
    lowms: [
        "92.118.16.0 - 92.118.16.127",
        "92.118.16.0 - 92.118.16.255",
        "92.118.16.0 - 92.118.19.255",
        "92.118.16.128 - 92.118.16.255",
        "92.118.17.0 - 92.118.17.255",
        "92.118.18.0 - 92.118.18.127",
        "92.118.18.0 - 92.118.18.255",
        "92.118.18.128 - 92.118.18.255",
        "92.118.19.0 - 92.118.19.127",
        "92.118.19.0 - 92.118.19.255",
        "92.118.19.128 - 92.118.19.255",
    ],
    // Nitrado
    // https://apps.db.ripe.net/db-web-ui/query?bflag=false&dflag=false&inverse=mnt-by%3Bmnt-domains%3Bmnt-lower%3Bmnt-routes&rflag=true&searchtext=MNT-MARBIS&source=RIPE
    nitrado: [
        "109.230.197.0 - 109.230.197.255",
        "109.230.197.0/24",
        "109.230.208.0 - 109.230.208.255",
        "109.230.208.0/24",
        "109.230.211.0 - 109.230.211.255",
        "109.230.211.0/24",
        "109.230.214.0 - 109.230.214.255",
        "109.230.214.0/24",
        "109.230.240.0 - 109.230.241.255",
        "109.230.240.0/23",
        "109.230.243.0 - 109.230.243.255",
        "109.230.243.0/24",
        "109.230.248.0 - 109.230.249.255",
        "109.230.248.0/23",
        "128.0.112.0 - 128.0.113.255",
        "128.0.112.0 - 128.0.115.255",
        "128.0.112.0/22",
        "128.0.112.0/23",
        "128.0.114.0 - 128.0.115.255",
        "128.0.114.0/23",
        "134.255.198.0 - 134.255.198.255",
        "134.255.198.0/24",
        "134.255.208.0 - 134.255.209.255",
        "134.255.208.0/23",
        "134.255.212.0 - 134.255.213.255",
        "134.255.212.0 - 134.255.214.255",
        "134.255.212.0/23",
        "134.255.214.0 - 134.255.214.255",
        "134.255.214.0/24",
        "134.255.240.0 - 134.255.240.255",
        "134.255.240.0/24",
        "134.255.251.0 - 134.255.251.255",
        "134.255.251.0/24",
        "185.9.104.0 - 185.9.107.255",
        "185.9.104.0/22",
        "194.169.211.0 - 194.169.211.255",
        "194.169.211.0/24",
        "195.82.158.0 - 195.82.159.255",
        "195.82.158.0/23",
        "217.114.192.0 - 217.114.192.255",
        "217.114.192.0 - 217.114.199.255",
        "217.114.192.0/21",
        "217.114.192.0/24",
        "217.114.193.0 - 217.114.193.255",
        "217.114.193.0/24",
        "217.114.194.0 - 217.114.194.255",
        "217.114.194.0/24",
        "217.114.195.0 - 217.114.195.255",
        "217.114.195.0/24",
        "217.114.196.0 - 217.114.196.255",
        "217.114.196.0/24",
        "217.114.197.0 - 217.114.197.255",
        "217.114.197.0/24",
        "217.114.198.0 - 217.114.198.255",
        "217.114.198.0/24",
        "217.114.199.0 - 217.114.199.255",
        "217.114.199.0/24",
        "31.214.128.0 - 31.214.128.255",
        "31.214.128.0/24",
        "31.214.130.0 - 31.214.131.255",
        "31.214.130.0/23",
        "31.214.134.0 - 31.214.135.255",
        "31.214.134.0 - 31.214.136.255",
        "31.214.134.0/23",
        "31.214.136.0 - 31.214.136.255",
        "31.214.136.0/24",
        "31.214.142.0 - 31.214.143.255",
        "31.214.142.0/23",
        "31.214.148.0 - 31.214.148.255",
        "31.214.148.0/24",
        "31.214.158.0 - 31.214.159.255",
        "31.214.158.0 - 31.214.167.255",
        "31.214.158.0/23",
        "31.214.160.0 - 31.214.160.255",
        "31.214.160.0/21",
        "31.214.160.0/24",
        "31.214.161.0 - 31.214.161.255",
        "31.214.161.0/24",
        "31.214.162.0 - 31.214.162.255",
        "31.214.162.0/24",
        "31.214.163.0 - 31.214.163.255",
        "31.214.163.0/24",
        "31.214.164.0 - 31.214.167.255",
        "31.214.164.0/22",
        "31.214.192.0 - 31.214.195.255",
        "31.214.192.0 - 31.214.199.255",
        "31.214.192.0/21",
        "31.214.192.0/22",
        "31.214.196.0 - 31.214.199.255",
        "31.214.196.0/22",
        "31.214.202.0 - 31.214.203.255",
        "31.214.202.0 - 31.214.211.255",
        "31.214.202.0/23",
        "31.214.204.0 - 31.214.207.255",
        "31.214.204.0/22",
        "31.214.208.0 - 31.214.211.255",
        "31.214.208.0/22",
        "31.214.216.0 - 31.214.217.255",
        "31.214.216.0 - 31.214.221.255",
        "31.214.216.0/22",
        "31.214.216.0/23",
        "31.214.218.0 - 31.214.218.255",
        "31.214.218.0/24",
        "31.214.219.0 - 31.214.219.255",
        "31.214.219.0/24",
        "31.214.220.0 - 31.214.221.255",
        "31.214.220.0/23",
        "31.214.224.0 - 31.214.227.255",
        "31.214.224.0/22",
        "31.214.232.0 - 31.214.239.255",
        "31.214.232.0/21",
        "37.10.104.0 - 37.10.105.255",
        "37.10.104.0/22",
        "37.10.104.0/23",
        "37.10.106.0 - 37.10.106.255",
        "37.10.106.0/24",
        "37.10.107.0 - 37.10.107.255",
        "37.10.107.0/24",
        "37.10.115.0 - 37.10.115.255",
        "37.10.115.0/24",
        "37.10.118.0 - 37.10.118.255",
        "37.10.118.0 - 37.10.127.255",
        "37.10.118.0/23",
        "37.10.118.0/24",
        "37.10.119.0 - 37.10.119.255",
        "37.10.119.0/24",
        "37.10.120.0 - 37.10.123.255",
        "37.10.120.0/21",
        "37.10.120.0/22",
        "37.10.124.0 - 37.10.127.255",
        "37.10.124.0/22",
        "37.10.96.0 - 37.10.103.255",
        "37.10.96.0 - 37.10.107.255",
        "37.10.96.0/21",
        "45.140.128.0 - 45.140.129.255",
        "45.140.128.0 - 45.140.131.255",
        "45.140.128.0/22",
        "45.140.128.0/23",
        "45.140.130.0 - 45.140.130.255",
        "45.140.130.0/24",
        "45.140.131.0 - 45.140.131.255",
        "45.140.131.0/24",
        "45.159.4.0 - 45.159.5.255",
        "45.159.4.0 - 45.159.7.255",
        "45.159.4.0/22",
        "45.159.4.0/23",
        "45.159.6.0/24",
        "45.159.7.0/24",
        "46.251.228.0 - 46.251.228.255",
        "46.251.228.0 - 46.251.236.255",
        "46.251.228.0/22",
        "46.251.228.0/24",
        "46.251.229.0 - 46.251.229.255",
        "46.251.229.0/24",
        "46.251.230.0 - 46.251.230.255",
        "46.251.230.0/24",
        "46.251.231.0 - 46.251.231.255",
        "46.251.231.0/24",
        "46.251.232.0 - 46.251.233.255",
        "46.251.232.0/22",
        "46.251.232.0/23",
        "46.251.234.0 - 46.251.234.255",
        "46.251.234.0/24",
        "46.251.235.0 - 46.251.235.255",
        "46.251.235.0/24",
        "46.251.236.0 - 46.251.236.255",
        "46.251.236.0/24",
        "46.251.238.0 - 46.251.238.255",
        "46.251.238.0/24",
        "46.251.240.0 - 46.251.247.255",
        "46.251.240.0 - 46.251.248.255",
        "46.251.240.0/21",
        "46.251.248.0 - 46.251.248.255",
        "46.251.248.0/24",
        "5.101.160.0 - 5.101.167.255",
        "5.101.160.0/21",
        "5.62.112.0 - 5.62.112.255",
        "5.62.112.0/24",
        "5.62.113.0 - 5.62.113.255",
        "5.62.113.0/24",
        "5.62.114.0 - 5.62.114.255",
        "5.62.114.0/24",
        "5.62.115.0 - 5.62.115.255",
        "5.62.115.0/24",
        "5.62.116.0 - 5.62.116.255",
        "5.62.116.0/24",
        "5.62.117.0 - 5.62.117.255",
        "5.62.117.0/24",
        "5.62.118.0 - 5.62.118.255",
        "5.62.118.0/24",
        "5.62.119.0 - 5.62.119.255",
        "5.62.119.0/24",
        "5.62.120.0 - 5.62.120.255",
        "5.62.120.0/24",
        "5.62.121.0 - 5.62.121.255",
        "5.62.121.0/24",
        "5.62.122.0 - 5.62.122.255",
        "5.62.122.0/24",
        "5.62.123.0 - 5.62.123.255",
        "5.62.123.0/24",
        "5.62.124.0 - 5.62.125.255",
        "5.62.124.0/23",
        "5.62.126.0 - 5.62.126.255",
        "5.62.126.0/24",
        "5.62.127.0 - 5.62.127.255",
        "5.62.127.0/24",
        "5.62.64.0 - 5.62.65.255",
        "5.62.64.0 - 5.62.71.255",
        "5.62.64.0/21",
        "5.62.64.0/23",
        "5.62.66.0 - 5.62.66.255",
        "5.62.66.0/24",
        "5.62.67.0 - 5.62.67.255",
        "5.62.67.0/24",
        "5.62.68.0 - 5.62.69.255",
        "5.62.68.0/23",
        "5.62.70.0 - 5.62.70.255",
        "5.62.70.0/24",
        "5.62.71.0 - 5.62.71.255",
        "5.62.71.0/24",
        "5.62.96.0 - 5.62.111.255",
        "5.62.96.0 - 5.62.127.255",
        "5.62.96.0/19",
        "5.62.96.0/20",
        "5.83.160.0 - 5.83.163.255",
        "5.83.160.0 - 5.83.175.255",
        "5.83.160.0/20",
        "5.83.160.0/22",
        "5.83.164.0 - 5.83.165.255",
        "5.83.164.0/23",
        "5.83.166.0 - 5.83.166.255",
        "5.83.166.0/24",
        "5.83.167.0 - 5.83.167.255",
        "5.83.167.0/24",
        "5.83.168.0 - 5.83.171.255",
        "5.83.168.0/22",
        "5.83.172.0 - 5.83.173.255",
        "5.83.172.0/23",
        "5.83.174.0 - 5.83.175.255",
        "5.83.174.0/23",
        "85.190.128.0 - 85.190.129.255",
        "85.190.128.0 - 85.190.175.255",
        "85.190.128.0/19",
        "85.190.128.0/23",
        "85.190.130.0 - 85.190.131.255",
        "85.190.130.0/23",
        "85.190.132.0 - 85.190.133.255",
        "85.190.132.0/23",
        "85.190.134.0 - 85.190.135.255",
        "85.190.134.0/23",
        "85.190.136.0 - 85.190.136.255",
        "85.190.136.0/24",
        "85.190.137.0 - 85.190.137.255",
        "85.190.137.0/24",
        "85.190.138.0 - 85.190.139.255",
        "85.190.138.0/23",
        "85.190.140.0 - 85.190.143.255",
        "85.190.140.0/22",
        "85.190.144.0 - 85.190.144.255",
        "85.190.144.0/24",
        "85.190.145.0 - 85.190.145.255",
        "85.190.145.0/24",
        "85.190.146.0 - 85.190.146.255",
        "85.190.146.0/24",
        "85.190.147.0 - 85.190.147.255",
        "85.190.147.0/24",
        "85.190.148.0 - 85.190.148.255",
        "85.190.148.0/24",
        "85.190.149.0 - 85.190.149.255",
        "85.190.149.0/24",
        "85.190.150.0 - 85.190.150.255",
        "85.190.150.0/24",
        "85.190.151.0 - 85.190.151.255",
        "85.190.151.0/24",
        "85.190.152.0 - 85.190.152.255",
        "85.190.152.0/24",
        "85.190.153.0 - 85.190.153.255",
        "85.190.153.0/24",
        "85.190.154.0 - 85.190.155.255",
        "85.190.154.0/23",
        "85.190.156.0 - 85.190.157.255",
        "85.190.156.0/23",
        "85.190.158.0 - 85.190.158.255",
        "85.190.158.0/24",
        "85.190.159.0 - 85.190.159.255",
        "85.190.159.0/24",
        "85.190.160.0 - 85.190.163.255",
        "85.190.160.0/20",
        "85.190.160.0/22",
        "85.190.164.0 - 85.190.167.255",
        "85.190.164.0/22",
        "85.190.168.0 - 85.190.171.255",
        "85.190.168.0/22",
        "85.190.172.0 - 85.190.175.255",
        "85.190.172.0/22",
        "95.156.193.0 - 95.156.193.255",
        "95.156.193.0 - 95.156.194.255",
        "95.156.193.0/24",
        "95.156.194.0 - 95.156.194.255",
        "95.156.194.0/24",
        "95.156.198.0 - 95.156.198.255",
        "95.156.198.0/24",
        "95.156.209.0 - 95.156.209.255",
        "95.156.209.0 - 95.156.211.255",
        "95.156.209.0/24",
        "95.156.210.0 - 95.156.210.255",
        "95.156.210.0/23",
        "95.156.210.0/24",
        "95.156.211.0 - 95.156.211.255",
        "95.156.211.0/24",
        "95.156.213.0 - 95.156.213.255",
        "95.156.213.0/24",
        "95.156.220.0 - 95.156.221.255",
        "95.156.220.0/23",
        "95.156.224.0 - 95.156.224.255",
        "95.156.224.0/24",
        "95.156.238.0 - 95.156.238.255",
        "95.156.238.0 - 95.156.239.255",
        "95.156.238.0/23",
        "95.156.238.0/24",
        "95.156.239.0 - 95.156.239.255",
        "95.156.239.0/24",
        "95.156.250.0 - 95.156.250.255",
        "95.156.250.0/24",
    ],
}

function inAnyRange(ip, ranges) {
    for (const range of ranges) {
        const inRange = ipv4.inRange(ip, range);
        if (inRange) {
            return true;
        }
    }
}

export function findMostLikely(server) {
    const name = server.data().name.toLowerCase();
    const ip = server.data().query.split(":")[0];
    const port = server.data().query.split(":")[1];

    if (inbetween(port, 7000, 7999)) {
        return "Qonzer (7xxx)"
    } else if (inAnyRange(ip, hostIpRanges.gportal)) {
        return "G-Portal (IP-ranges)"
    } else if (inAnyRange(ip, hostIpRanges.lowms)) {
        return "Low.MS (IP-ranges)"
    } else if (inAnyRange(ip, hostIpRanges.streamline)) {
        return "Streamline (IP-ranges)"
    } else if (inAnyRange(ip, hostIpRanges.nitrado)) {
        return "Nitrado (IP-ranges)"
    } else if (inbetween(port, 26000, 32999)) {
        // GTX uses several different upstream providers
        // Assume any IP not in confirmed ranges of other providers above is GTX instead
        return "GTX (26xxx-32xxx)"
    }

    if (name.includes("qonzer")) {
        return "Qonzer (Name)"
    } else if (name.includes("g-portal")) {
        return "G-Portal (Name)"
    } else if (name.includes("low.ms")) {
        return "Low.MS (Name)"
    } else if (name.includes("streamline")) {
        return "Streamline (Name)"
    } else if (name.includes("nitrado")) {
        return "Nitrado (Name)"
    } else if (name.includes("gtx")) {
        return "GTX (Name)"
    }

    return "Unknown"
}